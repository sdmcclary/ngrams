public class HtmlParser01 implements HtmlParser { enum STATE { UNKNOWN , IN_BODY } private STATE state = STATE . UNKNOWN ; private StringBuilder buf = null ; private char c ; private int cnt = 0 ; Reader input ; Writer output ; public void parse ( Reader input , Writer output ) throws Exception { this . input = input ; this . output = output ; int i ; while ( - 1 != ( i = input . read ( ) ) ) { this . c = ( char ) i ; this . cnt ++ ; switch ( this . state ) { case IN_BODY : this . handleInBody ( ) ; break ; default : this . handleUnknown ( ) ; break ; } } } private void handleUnknown ( ) throws Exception { if ( '<' == c && null == buf ) { this . buf = new StringBuilder ( ) ; } else if ( '>' == c && null != buf ) { if ( "body" . equals ( buf . toString ( ) ) ) { this . state = STATE . IN_BODY ; } this . buf = null ; } else if ( null != buf ) { this . buf . append ( this . c ) ; } else { } } private void handleInBody ( ) throws Exception { if ( '<' == this . c ) { this . state = STATE . UNKNOWN ; handleUnknown ( ) ; return ; } output . append ( this . c ) ; } private void raiseException ( ) throws Exception { throw new Exception ( "Parse Error: cnt -> " + cnt + " c -> " + this . c + " state -> " + this . state + " buffer -> " + this . buf ) ; } public Reader getInput ( ) { return input ; } public void setInput ( Reader input ) { this . input = input ; } public Writer getOutput ( ) { return output ; } public void setOutput ( Writer output ) { this . output = output ; } } 