public final class TableChecker extends Checker { public TableChecker ( ) { super ( ) ; } private Table current ; private final LinkedList < Table > stack = new LinkedList < Table > ( ) ; private void push ( ) { if ( current != null ) { stack . addLast ( current ) ; } current = new Table ( this ) ; } private void pop ( ) throws SAXException { if ( current == null ) { throw new IllegalStateException ( "Bug!" ) ; } current . end ( ) ; if ( stack . isEmpty ( ) ) { current = null ; } else { current = stack . removeLast ( ) ; } } public void startElement ( String uri , String localName , String qName , Attributes atts ) throws SAXException { if ( "http://www.w3.org/1999/xhtml" . equals ( uri ) ) { if ( "table" . equals ( localName ) ) { push ( ) ; } else if ( current != null ) { if ( "td" . equals ( localName ) ) { current . startCell ( false , atts ) ; } else if ( "th" . equals ( localName ) ) { current . startCell ( true , atts ) ; } else if ( "tr" . equals ( localName ) ) { current . startRow ( ) ; } else if ( "tbody" . equals ( localName ) || "thead" . equals ( localName ) || "tfoot" . equals ( localName ) ) { current . startRowGroup ( localName ) ; } else if ( "col" . equals ( localName ) ) { current . startCol ( AttributeUtil . parseNonNegativeInteger ( atts . getValue ( "" , "span" ) ) ) ; } else if ( "colgroup" . equals ( localName ) ) { current . startColGroup ( AttributeUtil . parseNonNegativeInteger ( atts . getValue ( "" , "span" ) ) ) ; } } } } public void endElement ( String uri , String localName , String qName ) throws SAXException { if ( "http://www.w3.org/1999/xhtml" . equals ( uri ) ) { if ( "table" . equals ( localName ) ) { pop ( ) ; } else if ( current != null ) { if ( "td" . equals ( localName ) ) { current . endCell ( ) ; } else if ( "th" . equals ( localName ) ) { current . endCell ( ) ; } else if ( "tr" . equals ( localName ) ) { current . endRow ( ) ; } else if ( "tbody" . equals ( localName ) || "thead" . equals ( localName ) || "tfoot" . equals ( localName ) ) { current . endRowGroup ( ) ; } else if ( "col" . equals ( localName ) ) { current . endCol ( ) ; } else if ( "colgroup" . equals ( localName ) ) { current . endColGroup ( ) ; } } } } public void reset ( ) { stack . clear ( ) ; current = null ; } } 